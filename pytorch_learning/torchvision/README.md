# 用户使用说明书

作者：电子与信息学院 | 22级信息工程 | 1班于浩林 2班王承志

## 一、基于蓝图可分离卷积的轻量化花卉识别系统

本系统是一个基于PyTorch深度学习框架开发的花卉识别系统，通过引入蓝图可分离卷积实现模型轻量化。核心组件包括模型的训练、验证、测试、使用以及流程可视化和GUI设计等多个模块或子系统。系统采用基于IMAGENET1K_V1数据集训练的ResNet-34模型作为基础，通过迁移学习的方法对花卉数据集进行分类。主要目标是实现一个高效、准确的花卉分类模型，并提供直观的训练过程可视化和简洁的用户图形界面。此外,系统提供通用深度学习框架下目标分类任务的基础性全流程,可满足用户的高度定制化需求。

## 二、先决条件

为保证最佳兼容性和性能，在运行代码之前，您需要安装以下先决条件：

- **Linux 操作系统** - 本系统全程基于 Linux 系统的发行版 Ubuntu 22.04 进行构建和验证，为保证最佳兼容性和性能，请尽量在此系统及版本下运行。
- **PyTorch** - 开源深度学习框架，版本：*2.0.1*
- **CUDA** - NVIDIA 推出的一种并行计算平台和编程模型，版本： *11.7*
- **cuDNN** - GPU加速的深度神经网络基元库，版本： *8500*
- **OpenCV** - 用于简单的图像处理，您可以使用软件包管理器安装它，或者按照OpenCV网站上的安装说明进行安装。
- **其他依赖项** - 在项目根目录下找到`requirements.txt`文件，使用 pip 包管理器及指令`pip install -r requirements.txt`安装。

## 三、用法

### 基础用法

实现花卉识别：运行项目根目录下的`window.py`文件，根据界面提示操作（基础功能仅支持上传预置的五种花卉：*雏菊，蒲公英，玫瑰，向日葵，郁金香*）
![GUI](result_img/GUI.png)

### 进阶用法

根据自身任务需求，使用自定义数据集重新训练新的模型，获得非常AMAZING的万能识图小能手。

- 1. 更换`data`文件夹下的数据集，确保按照如下格式组织数据。
```
    root/dog/xxx.png
    root/dog/xxy.png
    root/dog/[...]/xxz.png
```
- 2. 运行脚本`references/other_reference/data_split.py`实现 *8:1:1* 的训练集、验证集和测试集的划分。
- 3. 运行脚本`train.py`，通过进度条监测训练过程，等待训练结束。
![tqdm](result_img/tqdm.png "训练过程可视化")
- 4. 在当前项目根目录的终端输入如下指令：
```
    tensorboard --logdir=runs
```
点击输出信息结尾处的超链接，进入*TensorBoard*，监测模型训练验证过程，同时对模型数据进行评估和可视化分析，如下：
![loss](result_img/loss.png)
![pr](result_img/pr_1epoch.png)
![wrong](result_img/show_wrong_img.png)

- 5. 运行脚本`test.py`，对模型性能、泛化性及鲁棒性进行无偏差评估。

## 四、许可证

本项目根据MIT许可证授权 - 有关详细信息，请参阅[LICENSE](LICENSE)文件。
